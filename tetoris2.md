# Pythonでテトリスを作ることでよく知らない分野の実装手順について考察する（2）実装編

今回は後編として、実装したコードについて書きます。
前回の記事は以下です。
https://let-piyomaru.hatenablog.com/entry/2020/03/03/185751
リポジトリは以下です。
https://github.com/tanapiyo/PythonConsolePlaying
実装する際にどういう手順で取り掛かるかも悩んだので、私が実際に考えた順に記事を書きます。内容としてはクラス設計、実装を悩んだ箇所の調査、実際の実装という順番です。
ちなみにまだリポジトリのコードは動きません。とりあえず動いたら追記します。

## クラス設計
### ゲームクラス
- フィールド
    - スクリーン
    - テトリミノ
    - 次に落下するテトリミノ
- メソッド
    - 初期化
    - テトリミノの衝突判定（衝突していたら固定）
    - 1行埋まったかの判定
    - 次に落下するテトリミノの生成（種類・回転をランダムに決定）
    - ゲームオーバー判定（次に落下するテトリミノが入りきらない時）
    - メインからゲームループの中で呼ばれる処理（ゲームの流れの管理）
    - スクリーンの描画処理

### テトリミノクラス
- フィールド
    - x座標
    - y座標
    - 回転の種類
    - テトリミノの種類
- メソッド
    - テトリミノの左右移動
    - テトリミノの下移動

## シーケンス設計
### 初期化
- スクリーンの初期化
- テトリミノの初期化
- スクリーンの表示
- 次に落下するテトリミノの生成（種類・回転をランダムに決定）
- 左右と回転

### ゲームループの中
- テトリミノの衝突判定
    - 衝突していたら次に落下するテトリミノの生成
    - していなければテトリミノのy座標を1つ落とす
- キー入力があれば動かせるか判定してテトリミノの操作
- ゲームオーバー判定
- スクリーンの描画処理

## 詰まった実装
### Pythonでキー入力を受け取る
- pip install readchar
```python
import readchar
while True:
    kb = readchar.readchar()
    if kb == "q":
        break
    else:
        print(kb)
```
（注意）上記の実装だとキー入力があるまでループが止まります

### キー入力で待たない
こちらの記事のコードをお借りしました。


### （だいたい）1秒ごとに描画ループ
```python
import time
while True:
    # 何か処理
    time.sleep(1)
```


-----
(参考)
https://qiita.com/pukin/items/3b791b8b759dd704f765